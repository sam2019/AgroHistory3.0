!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}((function(e){var n,i=e(window).width(),o=e(window).height(),l=[];e(window).resize((function(){clearTimeout(n),n=setTimeout((function(){e(window).width()===i&&e(window).height()===o||(e(l).each((function(){e(this).flexMenu({undo:!0}).flexMenu(this.options)})),i=e(window).width(),o=e(window).height())}),200)})),e.fn.flexMenu=function(n){var i,o=e.extend({threshold:2,cutoff:2,linkText:"More",linkTitle:"View More",linkTextAll:"Menu",linkTitleAll:"Open/Close Menu",shouldApply:function(){return!0},showOnHover:!0,popupAbsolute:!0,popupClass:"",undo:!1},n);return this.options=o,(i=e.inArray(this,l))>=0?l.splice(i,1):l.push(this),this.each((function(){var n,i,l,t,f,u,r=e(this),d=r.find("> li"),p=d.first(),s=d.last(),a=d.length,h=Math.floor(p.offset().top),c=Math.floor(p.outerHeight(!0)),M=!1;function w(e){return Math.ceil(e.offset().top)>=h+c}if(w(s)&&a>o.threshold&&!o.undo&&r.is(":visible")&&o.shouldApply()){var v=e('<ul class="flexMenu-popup"></ul>');for(v.addClass(o.popupClass),u=a;u>1;u--){if(i=w(n=r.find("> li:last-child")),u-1<=o.cutoff){e(r.children().get().reverse()).appendTo(v),M=!0;break}if(!i)break;n.appendTo(v)}M?r.append('<li class="flexMenu-viewMore flexMenu-allInPopup"><a href="#">'+o.linkTextAll+"</a></li>"):r.append('<li class="parent flexMenu-viewMore"><a href="#">'+o.linkText+"</a></li>"),w(l=r.find("> li.flexMenu-viewMore"))&&r.find("> li:nth-last-child(2)").appendTo(v),v.children().each((function(e,n){v.prepend(n)})),l.append(v),r.find("> li.flexMenu-viewMore > a").click((function(n){var i;i=l,e("li.flexMenu-viewMore.active").not(i).removeClass("active").find("> ul").hide(),l.toggleClass("open"),n.preventDefault()})),o.showOnHover&&"undefined"!=typeof Modernizr&&!Modernizr.touch&&l.hover((function(){}),(function(){}))}else if(o.undo&&r.find("ul.flexMenu-popup")){for(t=(f=r.find("ul.flexMenu-popup")).find("li").length,u=1;u<=t;u++)f.find("> li:first-child").appendTo(r);f.remove(),r.find("> li.flexMenu-viewMore").remove()}}))}}));